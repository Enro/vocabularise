/*!
 * jScrollPane - v2.0.0beta11 - 2011-07-04
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b,Ea,m){b.fn.jScrollPane=function(x){function ca(d,x){function da(a){var e,p,B,o,i,r=false,k=false;c=a;if(f===m)o=d.scrollTop(),i=d.scrollLeft(),d.css({overflow:"hidden",padding:0}),h=d.innerWidth()+J,j=d.innerHeight(),d.width(h),f=b('<div class="jspPane" />').css("padding",ka).append(d.children()),g=b('<div class="jspContainer" />').css({width:h+"px",height:j+"px"}).append(f).appendTo(d);else{d.css("width","");r=c.stickToBottom&&ta();k=c.stickToRight&&ua();if(B=d.innerWidth()+J!=h||d.outerHeight()!=
j)h=d.innerWidth()+J,j=d.innerHeight(),g.css({width:h+"px",height:j+"px"});if(!B&&la==s&&f.outerHeight()==q){d.width(h);return}la=s;f.css("width","");d.width(h);g.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}f.css("overflow","auto");s=a.contentWidth?a.contentWidth:f[0].scrollWidth;q=f[0].scrollHeight;f.css("overflow","");ea=s/h;V=q/j;w=V>1;v=ea>1;if(!v&&!w)d.removeClass("jspScrollable"),f.css({top:0,width:g.width()-J}),g.unbind(fa),f.find(":input,a").unbind("focus.jsp"),d.attr("tabindex",
"-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp"),ma(),na();else{d.addClass("jspScrollable");if(a=c.maintainPosition&&(l||n))e=C(),p=D();ca();va();wa();a&&(M(k?s-h:e,false),E(r?q-j:p,false));xa();ya();za();c.enableKeyboardNavigation&&Aa();c.clickOnTrack&&Ba();Ca();c.hijackInternalLinks&&oa()}c.autoReinitialise&&!W?W=setInterval(function(){da(c)},c.autoReinitialiseDelay):!c.autoReinitialise&&W&&clearInterval(W);o&&d.scrollTop(0)&&E(o,false);i&&d.scrollLeft(0)&&M(i,false);d.trigger("jsp-initialised",
[v||w])}function ca(){w&&(g.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />'))),X=g.find(">.jspVerticalBar"),y=X.find(">.jspTrack"),t=y.find(">.jspDrag"),c.showArrows&&(N=c.arrowUp?b(c.arrowUp):b('<a class="jspArrow jspArrowUp" />'),O=c.arrowDown?b(c.arrowDown):b('<a class="jspArrow jspArrowDown" />'),
N.bind("mousedown.jsp",F(0,-1)).bind("lick.jsp",P),O.bind("mousedown.jsp",F(0,1)).bind("click.jsp",P),c.arrowScrollOnHover&&(N.bind("mouseover.jsp",F(0,-1,N)),O.bind("mouseover.jsp",F(0,1,O))),m===c.arrowUp&&m===c.arrowDown&&pa(y,c.verticalArrowPositions,N,O)),Q=j,g.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){Q-=b(this).outerHeight()}),t.hover(function(){t.addClass("jspHover")},function(){t.removeClass("jspHover")}).bind("mousedown.jsp",function(a){b("html").bind("dragstart.jsp selectstart.jsp",
P);t.addClass("jspActive");var e=a.pageY-t.position().top;b("html").bind("mousemove.jsp",function(a){K(a.pageY-e,false)}).bind("mouseup.jsp mouseleave.jsp",qa);return false}),ra())}function ra(){y.height(Q+"px");l=0;ga=c.verticalGutter+y.outerWidth();f.width(h-ga-J);try{X.position().left===0&&f.css("margin-left",ga+"px")}catch(a){}}function va(){v&&(g.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),
b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />'))),Y=g.find(">.jspHorizontalBar"),z=Y.find(">.jspTrack"),u=z.find(">.jspDrag"),c.showArrows&&(R=setting.arrowLeft?b(c.arrowLeft):b('<a class="jspArrow jspArrowLeft" />'),S=setting.arrowRight?b(c.arrowRight):b('<a class="jspArrow jspArrowRight" />'),R.bind("mousedown.jsp",F(-1,0)).bind("click.jsp",P),S.bind("mousedown.jsp",F(1,0)).bind("click.jsp",P),c.arrowScrollOnHover&&(R.bind("mouseover.jsp",F(-1,0,R)),S.bind("mouseover.jsp",
F(1,0,S))),m===c.arrowLeft&&m===c.arrowRight&&pa(z,c.horizontalArrowPositions,R,S)),u.hover(function(){u.addClass("jspHover")},function(){u.removeClass("jspHover")}).bind("mousedown.jsp",function(a){b("html").bind("dragstart.jsp selectstart.jsp",P);u.addClass("jspActive");var e=a.pageX-u.position().left;b("html").bind("mousemove.jsp",function(a){T(a.pageX-e,false)}).bind("mouseup.jsp mouseleave.jsp",qa);return false}),L=g.innerWidth(),sa())}function sa(){g.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){L-=
b(this).outerWidth()});z.width(L+"px");n=0}function wa(){if(v&&w){var a=z.outerHeight(),e=y.outerWidth();Q-=a;b(Y).find(">.jspCap:visible,>.jspArrow").each(function(){L+=b(this).outerWidth()});L-=e;j-=e;h-=a;z.parent().append(b('<div class="jspCorner" />').css("width",a+"px"));ra();sa()}v&&f.width(g.outerWidth()-J+"px");q=f.outerHeight();V=q/j;if(v){G=Math.ceil(1/ea*L);if(G>c.horizontalDragMaxWidth)G=c.horizontalDragMaxWidth;else if(G<c.horizontalDragMinWidth)G=c.horizontalDragMinWidth;u.width(G+
"px");H=L-G;ha(n)}if(w){I=Math.ceil(1/V*Q);if(I>c.verticalDragMaxHeight)I=c.verticalDragMaxHeight;else if(I<c.verticalDragMinHeight)I=c.verticalDragMinHeight;t.height(I+"px");A=Q-I;ia(l)}}function pa(a,e,c,b){var d="before",i="after";e=="os"&&(e=/Mac/.test(navigator.platform)?"after":"split");e==d?i=e:e==i&&(d=e,e=c,c=b,b=e);a[d](c)[i](b)}function F(a,e,c){return function(){Da(a,e,this,c);this.blur();return false}}function Da(a,e,p,d){var p=b(p).addClass("jspActive"),o,i,r=true,f=function(){a!==0&&
k.scrollByX(a*c.arrowButtonSpeed);e!==0&&k.scrollByY(e*c.arrowButtonSpeed);i=setTimeout(f,r?c.initialDelay:c.arrowRepeatFreq);r=false};f();o=d?"mouseout.jsp":"mouseup.jsp";d=d||b("html");d.bind(o,function(){p.removeClass("jspActive");i&&clearTimeout(i);i=null;d.unbind(o)})}function Ba(){ma();w&&y.bind("mousedown.jsp",function(a){if(a.originalTarget===m||a.originalTarget==a.currentTarget){var e=b(this),d=e.offset(),B=a.pageY-d.top-l,o,i=true,r=function(){var b=e.offset(),b=a.pageY-b.top-I/2,d=j*c.scrollPagePercent,
p=A*d/(q-j);if(B<0)l-p>b?k.scrollByY(-d):K(b);else if(B>0)l+p<b?k.scrollByY(d):K(b);else{f();return}o=setTimeout(r,i?c.initialDelay:c.trackClickRepeatFreq);i=false},f=function(){o&&clearTimeout(o);o=null;b(document).unbind("mouseup.jsp",f)};r();b(document).bind("mouseup.jsp",f);return false}});v&&z.bind("mousedown.jsp",function(a){if(a.originalTarget===m||a.originalTarget==a.currentTarget){var e=b(this),d=e.offset(),B=a.pageX-d.left-n,o,i=true,f=function(){var b=e.offset(),b=a.pageX-b.left-G/2,d=
h*c.scrollPagePercent,p=H*d/(s-h);if(B<0)n-p>b?k.scrollByX(-d):T(b);else if(B>0)n+p<b?k.scrollByX(d):T(b);else{g();return}o=setTimeout(f,i?c.initialDelay:c.trackClickRepeatFreq);i=false},g=function(){o&&clearTimeout(o);o=null;b(document).unbind("mouseup.jsp",g)};f();b(document).bind("mouseup.jsp",g);return false}})}function ma(){z&&z.unbind("mousedown.jsp");y&&y.unbind("mousedown.jsp")}function qa(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");t&&t.removeClass("jspActive");
u&&u.removeClass("jspActive")}function K(a,e){if(w){a<0?a=0:a>A&&(a=A);if(e===m)e=c.animateScroll;e?k.animate(t,"top",a,ia):(t.css("top",a),ia(a))}}function ia(a){if(a===m)a=t.position().top;g.scrollTop(0);l=a;var e=l===0,b=l==A,a=-(a/A)*(q-j);if(Z!=e||$!=b)Z=e,$=b,d.trigger("jsp-arrow-change",[Z,$,aa,ba]);c.showArrows&&(N[e?"addClass":"removeClass"]("jspDisabled"),O[b?"addClass":"removeClass"]("jspDisabled"));f.css("top",a);d.trigger("jsp-scroll-y",[-a,e,b]).trigger("scroll")}function T(a,e){if(v){a<
0?a=0:a>H&&(a=H);if(e===m)e=c.animateScroll;e?k.animate(u,"left",a,ha):(u.css("left",a),ha(a))}}function ha(a){if(a===m)a=u.position().left;g.scrollTop(0);n=a;var e=n===0,b=n==H,a=-(a/H)*(s-h);if(aa!=e||ba!=b)aa=e,ba=b,d.trigger("jsp-arrow-change",[Z,$,aa,ba]);c.showArrows&&(R[e?"addClass":"removeClass"]("jspDisabled"),S[b?"addClass":"removeClass"]("jspDisabled"));f.css("left",a);d.trigger("jsp-scroll-x",[-a,e,b]).trigger("scroll")}function E(a,e){K(a/(q-j)*A,e)}function M(a,e){T(a/(s-h)*H,e)}function U(a,
e,d){var f,o,i=0,r=0,k,l,n;try{f=b(a)}catch(m){return}o=f.outerHeight();a=f.outerWidth();g.scrollTop(0);for(g.scrollLeft(0);!f.is(".jspPane");)if(i+=f.position().top,r+=f.position().left,f=f.offsetParent(),/^body|html$/i.test(f[0].nodeName))return;f=D();k=f+j;i<f||e?l=i-c.verticalGutter:i+o>k&&(l=i-j+o+c.verticalGutter);l&&E(l,d);i=C();l=i+h;r<i||e?n=r-c.horizontalGutter:r+a>l&&(n=r-h+a+c.horizontalGutter);n&&M(n,d)}function C(){return-f.position().left}function D(){return-f.position().top}function ta(){var a=
q-j;return a>20&&a-D()<10}function ua(){var a=s-h;return a>20&&a-C()<10}function ya(){g.unbind(fa).bind(fa,function(a,e,b,d){a=n;e=l;k.scrollBy(b*c.mouseWheelSpeed,-d*c.mouseWheelSpeed,false);return a==n&&e==l})}function P(){return false}function xa(){f.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(a){U(a.target,false)})}function Aa(){function a(){var a=n,b=l;switch(e){case 40:k.scrollByY(c.keyboardSpeed,false);break;case 38:k.scrollByY(-c.keyboardSpeed,false);break;case 34:case 32:k.scrollByY(j*
c.scrollPagePercent,false);break;case 33:k.scrollByY(-j*c.scrollPagePercent,false);break;case 39:k.scrollByX(c.keyboardSpeed,false);break;case 37:k.scrollByX(-c.keyboardSpeed,false)}return p=a!=n||b!=l}var e,p,h=[];v&&h.push(Y[0]);w&&h.push(X[0]);f.focus(function(){d.focus()});d.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(c){if(!(c.target!==this&&(!h.length||!b(c.target).closest(h).length))){var d=n,f=l;switch(c.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:e=
c.keyCode;a();break;case 35:E(q-j);e=null;break;case 36:E(0),e=null}p=c.keyCode==e&&d!=n||f!=l;return!p}}).bind("keypress.jsp",function(b){b.keyCode==e&&a();return!p});c.hideFocus?(d.css("outline","none"),"hideFocus"in g[0]&&d.attr("hideFocus",true)):(d.css("outline",""),"hideFocus"in g[0]&&d.attr("hideFocus",false))}function Ca(){if(location.hash&&location.hash.length>1){var a,e,c=escape(location.hash);try{a=b(c)}catch(d){return}a.length&&f.find(c)&&(g.scrollTop()===0?e=setInterval(function(){g.scrollTop()>
0&&(U(c,true),b(document).scrollTop(g.position().top),clearInterval(e))},50):(U(c,true),b(document).scrollTop(g.position().top)))}}function na(){b("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function oa(){na();b("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var a=this.href.split("#");if(a.length>1&&(a=a[1],a.length>0&&f.find("#"+a).length>0))return U("#"+a,true),false})}function za(){var a,e,b,c,d,f=false;g.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",
function(g){g=g.originalEvent.touches[0];a=C();e=D();b=g.pageX;c=g.pageY;d=false;f=true}).bind("touchmove.jsp",function(g){if(f){var g=g.originalEvent.touches[0],h=n,j=l;k.scrollTo(a+b-g.pageX,e+c-g.pageY);d=d||Math.abs(b-g.pageX)>5||Math.abs(c-g.pageY)>5;return h==n&&j==l}}).bind("touchend.jsp",function(){f=false}).bind("click.jsp-touchclick",function(){if(d)return d=false})}var c,k=this,f,h,j,g,s,q,ea,V,w,v,t,A,l,u,H,n,X,y,ga,Q,I,N,O,Y,z,L,G,R,S,W,ka,J,la,Z=true,aa=true,$=false,ba=false,ja=d.clone(false,
false).empty(),fa=b.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";ka=d.css("paddingTop")+" "+d.css("paddingRight")+" "+d.css("paddingBottom")+" "+d.css("paddingLeft");J=(parseInt(d.css("paddingLeft"),10)||0)+(parseInt(d.css("paddingRight"),10)||0);b.extend(k,{reinitialise:function(a){a=b.extend({},c,a);da(a)},scrollToElement:function(a,b,c){U(a,b,c)},scrollTo:function(a,b,c){M(a,c);E(b,c)},scrollToX:function(a,b){M(a,b)},scrollToY:function(a,b){E(a,b)},scrollToPercentX:function(a,b){M(a*(s-
h),b)},scrollToPercentY:function(a,b){E(a*(q-j),b)},scrollBy:function(a,b,c){k.scrollByX(a,c);k.scrollByY(b,c)},scrollByX:function(a,b){var c=(C()+Math[a<0?"floor":"ceil"](a))/(s-h);T(c*H,b)},scrollByY:function(a,b){var c=(D()+Math[a<0?"floor":"ceil"](a))/(q-j);K(c*A,b)},positionDragX:function(a,b){T(a,b)},positionDragY:function(a,b){K(a,b)},animate:function(a,b,d,f){var g={};g[b]=d;a.animate(g,{duration:c.animateDuration,easing:c.animateEase,queue:false,step:f})},getContentPositionX:function(){return C()},
getContentPositionY:function(){return D()},getContentWidth:function(){return s},getContentHeight:function(){return q},getPercentScrolledX:function(){return C()/(s-h)},getPercentScrolledY:function(){return D()/(q-j)},getIsScrollableH:function(){return v},getIsScrollableV:function(){return w},getContentPane:function(){return f},scrollToBottom:function(a){K(A,a)},hijackInternalLinks:function(){oa()},destroy:function(){var a=D(),b=C();d.removeClass("jspScrollable").unbind(".jsp");d.replaceWith(ja.append(f.children()));
ja.scrollTop(a);ja.scrollLeft(b)}});da(x)}x=b.extend({},b.fn.jScrollPane.defaults,x);b.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){x[this]=x[this]||x.speed});return this.each(function(){var d=b(this),m=d.data("jsp");m?m.reinitialise(x):(m=new ca(d,x),d.data("jsp",m))})};b.fn.jScrollPane.defaults={showArrows:false,arrowUp:m,arrowDown:m,arrowLeft:m,arrowRight:m,maintainPosition:true,stickToBottom:false,stickToRight:false,clickOnTrack:true,autoReinitialise:false,
autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:m,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:false,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:true,hideFocus:false,
keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:0.8}})(jQuery,this);
